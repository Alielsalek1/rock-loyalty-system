@if ( loading ) {
<app-alert [message]="loadingMessage"></app-alert>
}

<div class="container">
  <div class="row vh-100 align-items-center">
    <form
      ngForm
      #registerForm="ngForm"
      class="col-lg-6 col-md-8 col-sm-10 col-12 offset-sm-1 offset-md-2 offset-lg-3 border-container fixer"
      (ngSubmit)="onSubmit()"
    >
      <h1 class="text-center mb-3" style="font-weight: 800">Register</h1>

      <div class="mb-3">
        <input
          type="text"
          class="form-control"
          name="name"
          ngModel
          #nameInput="ngModel"
          aria-describedby="emailHelpId"
          placeholder="Enter your name"
          required
          [ngClass]="{ 'is-invalid': !nameInput.valid && nameInput.touched }"
        />
        <div *ngIf="nameInput.errors?.required && nameInput.touched" class="invalid-feedback">
          Name is required
        </div>
      </div>

      <div class="mb-3">
        <input
          type="email"
          class="form-control"
          name="email"
          ngModel
          #emailInput="ngModel"
          email
          required
          aria-describedby="helpId"
          placeholder="Enter your email"
          [ngClass]="{ 'is-invalid': !emailInput.valid && emailInput.touched }"
        />
        <div
          *ngIf="emailInput.invalid && emailInput.touched"
          class="invalid-feedback"
        >
          @if (emailInput.errors?.required) {
          <div>Email is required</div>
          } @if (emailInput.errors?.email) {
          <div>Please enter a valid email address</div>
          }
        </div>
      </div>

      <div class="mb-3">
        <input
          type="text"
          class="form-control"
          #phoneNumberInput="ngModel"
          ngModel
          placeholder="Enter your phone number"
          name="phoneNumber"
          required
          pattern="^[0-9]{10,15}$"
          [ngClass]="{
            'is-invalid': !phoneNumberInput.valid && phoneNumberInput.touched
          }"
        />
        <div *ngIf="phoneNumberInput.errors?.required" class="invalid-feedback">
          Phone number is required
        </div>
        <div *ngIf="phoneNumberInput.errors?.pattern" class="invalid-feedback">
          Please enter a valid phone number
        </div>
      </div>

      <div class="mb-3">
        <input
          type="password"
          class="form-control"
          #passwordInput="ngModel"
          ngModel
          placeholder="Enter your password"
          name="password"
          required
          minlength="8"
          pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*])[A-Za-z\d!@#$%^&*]{8,}$"
          [ngClass]="{
            'is-invalid': !passwordInput.valid && passwordInput.touched
          }"
        />
        <div
          *ngIf="confirmPasswordInput.errors?.required"
          class="invalid-feedback"
        >
          password is required
        </div>
        <ul
          *ngIf="passwordInput.invalid && passwordInput.touched"
          class="invalid-feedback"
        >
          <li *ngIf="passwordInput.errors?.minlength">
            Password must be at least 8 characters long.
          </li>
          <li *ngIf="passwordInput.errors?.pattern">
            Password must contain at least one uppercase letter, one lowercase
            letter, one digit, and one special character.
          </li>
        </ul>
      </div>

      <div class="mb-3">
        <input
          type="password"
          class="form-control"
          #confirmPasswordInput="ngModel"
          ngModel
          placeholder="Confirm your password"
          name="confirmPassword"
          required
          [ngClass]="{
            'is-invalid':
              (!confirmPasswordInput.valid && confirmPasswordInput.touched) ||
              (confirmPasswordInput.touched &&
                passwordInput.value !== confirmPasswordInput.value)
          }"
        />
        <div
          *ngIf="
            confirmPasswordInput.touched &&
            passwordInput.value !== confirmPasswordInput.value
          "
          class="invalid-feedback"
        >
          Passwords do not match.
        </div>

        <div
          *ngIf="confirmPasswordInput.errors?.required"
          class="invalid-feedback"
        >
          confirm password is required
        </div>
      </div>

      <button
        class="btn btn-primary w-100 mb-1"
        [disabled]="
          !registerForm.valid ||
          passwordInput.value != confirmPasswordInput.value
        "
      >
        submit
      </button>
      <div class="d-flex flex-column align-items-end justify-content-end">
        <a
          class="icon-link icon-link-hover"
          [routerLink]="['/' + restuarantId, 'auth', 'login']"
        >
          alreay registered ?
        </a>
      </div>
      <div class="or-divider">
        <hr class="line" />
        <span class="or-text">or</span>
        <hr class="line" />
      </div>
      <div class="d-flex gap-2" style="padding-top: 10px;">
        <!-- This is a google SVG icon don't mind it -->
        <a class="btn btn-light w-100 d-flex align-items-center justify-content-center"
          style="height: 40px; border: 1px solid #888888;" (click)="onGoogleLogin()">
          <svg width="18" height="18" viewBox="0 0 18 18" style="margin-right: 8px;">
            <path fill="#4285F4"
              d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z" />
            <path fill="#34A853"
              d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2.04a4.8 4.8 0 0 1-2.7.75 4.8 4.8 0 0 1-4.52-3.36H1.83v2.07A8 8 0 0 0 8.98 17z" />
            <path fill="#FBBC05"
              d="M4.46 10.41A4.8 4.8 0 0 1 4.21 8.98a4.8 4.8 0 0 1 .25-1.43V5.48H1.83a8 8 0 0 0 0 7.01l2.63-2.08z" />
            <path fill="#EA4335"
              d="M8.98 3.58c1.32 0 2.5.45 3.44 1.35l2.54-2.54A8 8 0 0 0 8.98 1a8 8 0 0 0-7.15 4.48l2.63 2.07A4.8 4.8 0 0 1 8.98 3.58z" />
          </svg>
          Continue with Google
        </a>
      </div>
    </form>
  </div>
</div>
